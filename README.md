# ML Financial Forecasting

Machine learning pipeline that predicts stock price movements and generates trading signals. Tests whether ML models can beat a simple buy-and-hold strategy.

## What It Does

Uses historical price data for 5 tech stocks (AAPL, MSFT, GOOG, TSLA, AMZN) to:

1. Calculate technical indicators (SMA, RSI, MACD)
2. Train 3 ML models (Logistic Regression, Random Forest, XGBoost)
3. Generate buy/sell/hold signals
4. Backtest trading strategies
5. Compare results to buy-and-hold benchmark

Data: 2023 stock prices, ~260 observations per ticker

## Running the Pipeline

Run these commands in order:

```bash
# Step 1: Create features from raw data
python src/feature_engineering.py

# Step 2: Train the models
python src/train_model.py

# Step 3: Generate trading signals
python src/signal_generator.py

# Step 4: Backtest the strategy
python src/backtest.py
```

Each step needs the previous one to complete first.

## Project Structure

```
ml-financial-forecasting/
├── data/
│   ├── raw/                      # Your data files go here
│   └── processed/                # Generated by feature_engineering.py
├── src/
│   ├── feature_engineering.py    # Creates ML features
│   ├── train_model.py            # Trains 3 models
│   ├── signal_generator.py       # Makes trading signals
│   └── backtest.py               # Simulates trading
├── models/                       # Saved trained models
├── outputs/                      # Results and visualizations
└── tests/                        # Unit tests
```

## What Gets Created

After running the pipeline:

* **Models** : 3 trained models in `models/`
* **Signals** : Trading signals in `outputs/predictions/signals.csv`
* **Results** : Performance metrics in `outputs/backtest_results/`
* **Visualizations** : Equity curves, confusion matrices, feature importance

## Files Explained

**feature_engineering.py** - Loads raw prices, calculates returns and technical indicators, creates labels, splits into train/test

**train_model.py** - Trains Logistic Regression, Random Forest, and XGBoost. Evaluates with cross-validation and generates confusion matrices

**signal_generator.py** - Takes model predictions and converts them to BUY/SELL/HOLD signals. Creates ensemble signal by majority vote

**backtest.py** - Simulates trading with $10K starting capital. Tracks portfolio value, calculates Sharpe ratio, max drawdown, etc.

## Testing

Run tests to verify everything works:

```bash
python tests/test_feature_engineering.py
python tests/test_train_model.py
python tests/test_signal_generator.py
python tests/test_backtest.py
```

## Notes

This is a class project. The backtest period is short (60 days) and doesn't include transaction costs. Not intended for actual trading.
